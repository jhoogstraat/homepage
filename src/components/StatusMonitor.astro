---
interface Service {
  name: string;
  url?: string;
  status: 'operational' | 'degraded' | 'down' | 'maintenance';
  description?: string;
}

interface Props {
  services?: Service[];
  showDetailsLink?: boolean;
}

const defaultServices: Service[] = [
  { name: 'Homepage', status: 'operational', description: 'This site' },
  { name: 'Nextcloud', status: 'operational', url: 'https://cloud.example.com', description: 'File sync & share' },
  { name: 'Gitea', status: 'operational', url: 'https://git.example.com', description: 'Git repositories' },
  { name: 'Vaultwarden', status: 'operational', description: 'Password manager' },
  { name: 'Uptime Kuma', status: 'operational', description: 'Monitoring' },
];

const { services = defaultServices, showDetailsLink = true } = Astro.props as Props;

const statusColors = {
  operational: 'bg-green-500',
  degraded: 'bg-yellow-500',
  down: 'bg-red-500',
  maintenance: 'bg-blue-500',
};

const statusLabels = {
  operational: 'Operational',
  degraded: 'Degraded',
  down: 'Down',
  maintenance: 'Maintenance',
};
---

<div class="border border-border rounded-lg p-4">
  <div class="flex items-center justify-between mb-4">
    <h3 class="text-sm font-semibold uppercase tracking-wide opacity-70">Homelab Status</h3>
    <span class="text-xs opacity-50">Last checked: just now</span>
  </div>
  
  <div class="space-y-2">
    {services.map((service) => (
      <div class="flex items-center justify-between py-1.5 px-2 rounded hover:bg-secondary/30 transition-colors group">
        <div class="flex items-center gap-3">
          <span class={`w-2 h-2 rounded-full ${statusColors[service.status]} ${service.status === 'operational' ? 'animate-pulse' : ''}`}></span>
          <div>
            {service.url ? (
              <a href={service.url} target="_blank" rel="noopener noreferrer" class="hover:text-primary transition-colors">
                {service.name}
              </a>
            ) : (
              <span>{service.name}</span>
            )}
            {service.description && (
              <span class="text-xs opacity-50 ml-2 hidden sm:inline">— {service.description}</span>
            )}
          </div>
        </div>
        <span class="text-xs opacity-50 group-hover:opacity-70">{statusLabels[service.status]}</span>
      </div>
    ))}
  </div>
  
  <div class="mt-4 pt-3 border-t border-border flex items-center justify-between text-xs opacity-50">
    <span class="flex items-center gap-1.5">
      <span class="w-1.5 h-1.5 rounded-full bg-green-500"></span>
      All systems operational
    </span>
    {showDetailsLink && (
      <a href="/homelab" class="hover:text-primary transition-colors">View details →</a>
    )}
  </div>
</div>
